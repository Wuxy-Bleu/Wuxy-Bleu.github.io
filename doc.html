<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Docs">
  
  <meta name="description" content="Music-Website full stack devBlog">
  <meta property="og:description" content="Music-Website full stack devBlog">
  
  <meta property="og:type" content="blog">
  <title>Docs</title>
  <!-- Favicon -->
  
  <link rel="shortcut icon" href="📖">
  
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index.html">
      <div class="Navbar__Btn"><span>📖</span> <span>Home</span></div>
    </a>
    
    
    <span class="Navbar__Delim">&centerdot;</span>
    <a href="doc.html">
      <div class="Navbar__Btn"><span>📝</span> <span>Docs</span></div>
    </a>
    
    
    
    <span class="Navbar__Delim">&centerdot;</span>
    <a href="dairy.html">
      <div class="Navbar__Btn"><span>🖋</span> <span>DevDairy</span></div>
    </a>
    
    
    
    <span class="Navbar__Delim">&centerdot;</span>
    <a href="about.html">
      <div class="Navbar__Btn"><span>😀</span> <span>About Me</span></div>
    </a>
    
    
    
    <span class="Navbar__Delim">&centerdot;</span>
    <a href="movie.html">
      <div class="Navbar__Btn"><span>🎞️</span> <span>观影记录</span></div>
    </a>
    
    
  </nav>
  <header class="Header">
      
    <div class="Header__Cover">
        <img src="https://images.unsplash.com/photo-1526987917922-9d4068cdb4cf?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb">
      </div>
      
    <div class="Header__Spacer ">
    </div>
    
    <div class="Header__Icon"><span>📝</span></div>
    
    <h1 class="Header__Title">Docs</h1>
        
    <div class="DateTagBar">
          
      <span class="DateTagBar__Item DateTagBar__Date">Posted on Mon, Mar 8, 2021</span>
          
          
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--green">
            <a href="tag/SpringBoot.html">SpringBoot</a>
          </span>
          
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--default">
            <a href="tag/Vue.html">Vue</a>
          </span>
          
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
            <a href="tag/Java.html">Java</a>
          </span>
          
        </div>
        
  </header>
      <article id="https://www.notion.so/c4c7dfa2382a47458fc05f68c360255f" class="PageRoot PageRoot--FullWidth"><div id="https://www.notion.so/33d77d5ad6ce4e9699488bf640de65e5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGray">Last Updated: </mark></span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Date">@2021/03/08</span></span><span class="SemanticString"> </span></span></p></div><div id="https://www.notion.so/7fbfea2eab8c4258adb2dbf7bfd82bb8" class="ColorfulBlock ColorfulBlock--BgGray Callout"><div class="Callout__Icon"><div class="Icon">⬅️</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">to GitHub Repository </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/Wuxy-Bleu">Music_Project</a></span></span></p></div><h1 id="https://www.notion.so/6a60b1e638cd43efbd6f1c9a2ed2989e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/6a60b1e638cd43efbd6f1c9a2ed2989e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">目录</span></span></h1><ul id="https://www.notion.so/2789f0c38d3649a8aff71eba9c06cd5a" class="ColorfulBlock ColorfulBlock--BgOrange TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/6a60b1e638cd43efbd6f1c9a2ed2989e"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">目录</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/55e4a715b43b4ab89e56b03afd49d091"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">主要技术栈</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8a53b376ad934fe897681ddbc8b4673a"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">框架 + 工具</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/09e09c25922649fc896d3eee5b1ef44d"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">技术点列举，不包括逻辑</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/dd85d5f4b9e34775964b5bc9cbb3c605"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">SpringBoot后端</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6e30fd6523344969ae97e250a56452ca"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Music_backend 模块</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/00994473a9094a71b27be290241bf160"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Music_upload 模块</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/4a10f1cdb35f4796b0b4a645ee76f364"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Music-admin 模块</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/fd38fbd169854bf692b3a446041eb303"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">MySQL部分</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/4f48c1fb7c3a48338b9c9cc7bd1964cd"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">Spring Security + jwt + redis登录部分</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6736f9ea74b946df8d418809a9bb4359"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">前端 - 管理后台</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1d1b74f347044d7983f8d82e8b54f30d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">主要技术点</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7401871d020b4306ae7e6a90c3df37b1"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">前端 - 音乐网站</span></span></div></a></li></ul><div id="https://www.notion.so/f14f44146eda464094f1df2ea24fbd50" class="Divider"></div><h1 id="https://www.notion.so/55e4a715b43b4ab89e56b03afd49d091" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/55e4a715b43b4ab89e56b03afd49d091"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">主要技术栈</span></span></h1><h2 id="https://www.notion.so/8a53b376ad934fe897681ddbc8b4673a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8a53b376ad934fe897681ddbc8b4673a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">框架 + 工具</span></span></h2><div id="https://www.notion.so/71fc2c3f938e49f19420a83c26d2e361" class="Divider"></div><div id="https://www.notion.so/a51a9d0b6cf64b8ab59fe7184d869db9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Java,  Spring,  Spring Boot,  Mybatis,  Mybatis Plus</code></strong></em></span></span></p></div><div id="https://www.notion.so/df7acaf159b740b383d7ae762754fd61" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Spring Cloud,  Spring Cloud Alibaba,  Nacos</code></strong></em></span></span></p></div><div id="https://www.notion.so/da5c4ec0e15b4ac497846bee58c14adf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Lombok,  Swagger,  Actuator,  Fastjson</code></em></strong></span></span></p></div><div id="https://www.notion.so/a0615f7cb19b4f4dabb6c4ac2318dcf7" class="Divider"></div><div id="https://www.notion.so/0c35fc7cced94e108497c17ccd6b7f53" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Js,  Vue,  ElementUI,  Axios,  Nginx</em></strong></code></span></span></p></div><div id="https://www.notion.so/cee4ef479f5449d9bcaf5e8030d461aa" class="Divider"></div><div id="https://www.notion.so/c6a4720890084cb581344a1d72486403" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">MySQL,  Druid,  MongoDB,  Redis</code></strong></em></span></span></p></div><div id="https://www.notion.so/328cd686af9a4a16b369824afe484def" class="Divider"></div><div id="https://www.notion.so/bb2688faa16d469da1dd2f9edefea0fe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Intellj IDEA,  VS Code,  DataGrip,  Xshell/Xftp</code></strong></em></span></span></p></div><div id="https://www.notion.so/dd58b28753a344aabe222a8be4437105" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Aliyun ECS, OSS</code></strong></em></span></span></p></div><h2 id="https://www.notion.so/09e09c25922649fc896d3eee5b1ef44d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/09e09c25922649fc896d3eee5b1ef44d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">技术点列举，不包括逻辑</span></span></h2><div id="https://www.notion.so/805d26f84a3444b09284081723f86142" class="ColorfulBlock ColorfulBlock--ColorDefault ToDo"><div class="ToDo__Content"><div class="ToDo__Icon"><div class="IconCheckboxUnchecked"><svg viewBox="0 0 16 16"><path d="M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"></path></svg></div></div><div class="ToDo__Title"><span class="SemanticStringArray"><span class="SemanticString">TBD</span></span></div></div></div><h1 id="https://www.notion.so/dd85d5f4b9e34775964b5bc9cbb3c605" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/dd85d5f4b9e34775964b5bc9cbb3c605"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">SpringBoot后端</span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/c14db83175224fbd9774ccc39b443b79" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Maven多模块项目，后期可以做成微服务架构，大部分服务已注册进</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Nacos</code></span><span class="SemanticString">注册中心。</span></span></li></ul><div id="https://www.notion.so/8f5fd442c24e42408e54f3e6670f8fb2" class="ColumnList"><div id="https://www.notion.so/383055e90c2243599bec18b22718383c" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/fa320349faf247629f40035048a3ae9c" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F81d80d1a-20a4-4d4f-ba71-8d5f88bafc94%2FUntitled.png?width=384&amp;table=block&amp;id=fa320349-faf2-4762-9f40-035048a3ae9c"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F81d80d1a-20a4-4d4f-ba71-8d5f88bafc94%2FUntitled.png?width=384&amp;table=block&amp;id=fa320349-faf2-4762-9f40-035048a3ae9c" style="width:384px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div><div id="https://www.notion.so/d521a8e43db24ab7b8b17dced7311baa" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><pre id="https://www.notion.so/7502dfd916d845ab8032ca00b5eb1ecf" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>icu.bleuweb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>music_springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>music_springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span>springboot开发的微服务分布式音乐网站<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music_backend<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music_upload<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>forTestMongoDB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music_admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music_chat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music_mail<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music_amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>music_schedule_tasks<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">></span></span></span></span></span></code></pre></div></div><pre id="https://www.notion.so/14811ef86ca94201a6f219f01cbfc67b" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>//Versions，根模块中, also with </span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><span>Lombok,Swagger,Actuator,Log4j2/Slf4j</span></em></strong></mark></span><span class="SemanticString"><span>
springframework               5.1.14.RELEASE
spring-boot                   2.1.13.RELEASE
spring-cloud-dependencies      Greenwich.SR6
spring-cloud-alibaba-dependencies   2.1.0.RELEASE</span></span></span></code></pre><div id="https://www.notion.so/cc0236dbd3f04abfb2ead5a22ed2acee" class="Divider"></div><h2 id="https://www.notion.so/6e30fd6523344969ae97e250a56452ca" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/6e30fd6523344969ae97e250a56452ca"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Music_backend 模块</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/475fe5260cf84393af29bf3bcccd85c5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">每一首歌的信息被分散到 </span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">歌曲/歌手/专辑</strong></mark></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> </strong></span><span class="SemanticString">三张表中。</span></span></li><li id="https://www.notion.so/296c0f86fce140d8b1eb5202a1b2bf8b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">music_backend模块负责对于表的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">增删改查</mark></strong></span><span class="SemanticString">操作，每次增删改查会同时访问</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">三张表</strong></mark></span><span class="SemanticString">。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/5ddf736a9bd546ddb795cbead142bb0d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">表的增删改查利用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Mybatis + 注解</code></strong></span><span class="SemanticString">的方式实现。</span></span></li></ul></li><li id="https://www.notion.so/330895a6479a4821b657aed2cbf92e68" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Service层中对表的增删改查，设置了</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">事务回滚注解</mark></strong></span></span></li></ul><pre id="https://www.notion.so/3d539badde2b4590885d735122ff9e4d" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>@Override
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPink"><span>@Transactional</span></mark></span><span class="SemanticString"><span>
public int insertMusic(MusicBean musicBean)</span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/587490b520a745b8aa13a3247e1360a4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">该模块中利用 实现</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">HandlerInterceptor+@Configuration配置类</code></strong></span><span class="SemanticString">的方式实现了一个</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">拦截器。</strong></mark></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/cf3e11c2343143b5b1b64ef1fd1e9791" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">该拦截器会拦截所有Http请求，并以 </span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">yyyy-MM-dd HH:mm:ss a - 请求路径:%s 远程的ip:%s 端口:%s 请求状态码:%s</code></strong></mark></span><span class="SemanticString"> 格式将所有的请求写入本地文件。</span></span></li></ul></li></ul><div id="https://www.notion.so/8b387f6dd51e45169097308578de4662" class="Divider"></div><h2 id="https://www.notion.so/00994473a9094a71b27be290241bf160" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/00994473a9094a71b27be290241bf160"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Music_upload 模块</span></span></h2><div id="https://www.notion.so/6dc9cae0165444e0a661c025c65f3800" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">该模块主要负责文件上传到</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">阿里云OSS</mark></strong></span><span class="SemanticString">的业务，上传的同时会将</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">文件的URL地址写入到数据库</strong></mark></span><span class="SemanticString">中。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/4f55b9eadab24c03877c11d6c8f34f57" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">写入URL地址直接请求的Music_backend模块。</em></span></span></li><li id="https://www.notion.so/518f36b3127e4f7a8e8da82d33544527" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">调用aliyun oss api，</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">前端获取后端生成的签名后，直传Oss</strong></mark></span><span class="SemanticString">。</span></span></li></ul><pre id="https://www.notion.so/7e9798876aea43eeb8092c0d141502c5" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>//参照阿里云的实例代码，获取</span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>OSS客户端</span></mark></strong></span><span class="SemanticString"><span>
OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, secretAccessKey);

//oss client生成 policy和signature 
String postPolicy = ossClient.generatePostPolicy(expiration, policyConds);
String postSignature = ossClient.calculatePostSignature(postPolicy);</span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/1a6840b567e14990a0a2de61434c7b1e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">policy</code></strong></span><span class="SemanticString">(oss要求), </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">signature</code></strong></span><span class="SemanticString">(签名), </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">host+dir</strong></code></span><span class="SemanticString">(上传路径), </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">expire</strong></code></span><span class="SemanticString">(签名过期时间), </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">callbackUrl</strong></code></span><span class="SemanticString">(上传成功回调地址，因为没有公网ip，所以暂没用到)放入map中，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">传给前端</mark></strong></span><span class="SemanticString">。</span></span></li></ul><div id="https://www.notion.so/0947672cf67246108d229d873a7d43e2" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F799e3e3b-3a39-4542-950c-63cd17af6c1c%2FUntitled.png?width=1061&amp;table=block&amp;id=0947672c-f672-4610-8d22-9d873a7d43e2"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F799e3e3b-3a39-4542-950c-63cd17af6c1c%2FUntitled.png?width=1061&amp;table=block&amp;id=0947672c-f672-4610-8d22-9d873a7d43e2" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/4a10f1cdb35f4796b0b4a645ee76f364" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/4a10f1cdb35f4796b0b4a645ee76f364"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Music-admin 模块</span></span></h2><div id="https://www.notion.so/2f9e9e55bf6348bca95ce426e7e9280e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">主要负责单点登录相关的业务，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">这个模块比较大，繁杂</mark></strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/5179b86d2c7147eb9df39a929e5610d8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">后期将music 在线音乐网站的后端业务也写在了这个模块中😂。</span></span></p></div><div id="https://www.notion.so/b4e14a75108044aa9d4aa6ad0895eff3" class="Divider"></div><h3 id="https://www.notion.so/fd38fbd169854bf692b3a446041eb303" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/fd38fbd169854bf692b3a446041eb303"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">MySQL部分</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/58cde14470c34ae0b3c2c70d6c1c3478" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">该模块中</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Mybatis Plus</code></strong></span><span class="SemanticString">开发数据库的增删改查，继承于MP的mapper和service类提供了很多很有用的方法，可以满足大部分的增删改查的需求了，较为复杂的sql使用MP提供的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">QueryWrapper</code></strong></span><span class="SemanticString">来操作。</span></span></li><li id="https://www.notion.so/9b5d88155a4844c593f8b3a5df378e16" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">使用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Mybatis Plus Generator</code></strong></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> </strong></span><span class="SemanticString">自动生成了entity,mapper,service,controller的代码</span></span></li></ul><pre id="https://www.notion.so/524f4f7db26648f4a8dc9a6ae0e93044" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">//利用MP Generator的实例代码，该部分配置即可实现</span>
AutoGenerator mpg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AutoGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span><span class="token operator">...</span>
mpg<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span></span></code></pre><div id="https://www.notion.so/f3bfce085e4249358559608a18885b00" class="ColumnList"><div id="https://www.notion.so/58055b5925f94b55a4c397b90ff391d9" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.4375)"><div id="https://www.notion.so/15a84db542864fe684a0faa233245a3c" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa1975a24-1bc9-4ccd-9f7e-539fc57fe0d1%2FUntitled.png?width=336&amp;table=block&amp;id=15a84db5-4286-4fe6-84a0-faa233245a3c"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa1975a24-1bc9-4ccd-9f7e-539fc57fe0d1%2FUntitled.png?width=336&amp;table=block&amp;id=15a84db5-4286-4fe6-84a0-faa233245a3c" style="width:336px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div><div id="https://www.notion.so/7ef2ece07eab4d70a2574d56b7ce5d43" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5625)"><div id="https://www.notion.so/2e38314b88f6420e9a233747e3f5e156" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这是我的配置生成的代码，我的使用方法是将部分对我有用的entity实体类，mapper类，复制粘贴出来，可以少写很多代码……</span></span></p></div><div id="https://www.notion.so/425d52b3ef284f08964974123c4a1267" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></div></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/291f24fa0cba48a3b867e79b101e1778" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">多数据源</mark></strong></span><span class="SemanticString">开发，使用了</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">注解 + AOP + extends AbstractRoutingDataSource</strong></code></span><span class="SemanticString">的方式实现了动态数据源
因为要连接两个数据库</span></span></li></ul><pre id="https://www.notion.so/cc752c8ea09b45c290254336d824b94f" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment"># </span></span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>配置好两个数据源</span></mark></strong></span><span class="SemanticString"><span> 在application.yml中
<span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">druid</span><span class="token punctuation">:</span>
      <span class="token key atrule">music-admin</span><span class="token punctuation">:</span>
        <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/music_admin<span class="token punctuation">?</span>serverTimezone=UTC
        <span class="token key atrule">username</span><span class="token punctuation">:</span> root
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
        <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
      <span class="token key atrule">tp-music</span><span class="token punctuation">:</span>
        <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/tp_music<span class="token punctuation">?</span>serverTimezone=UTC
        <span class="token key atrule">username</span><span class="token punctuation">:</span> root
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
        <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver</span></span></span></code></pre><pre id="https://www.notion.so/ba57b0d47fb3420eb7168c6cb77de570" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>// </span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>配置类  读取配置将两个数据源类注入到容器中，同时注入数据源切换类DynamicDataSource</span></strong></mark></span><span class="SemanticString"><span>
@Configuration
public class DynamicDataSourceConfig {

    @Bean
    @ConfigurationProperties(&quot;spring.datasource.druid.music-admin&quot;)
    public DataSource oneDataSource() {
        DataSource dataSource = DruidDataSourceBuilder.create().build();
        return dataSource;
    }

    @Bean
    @ConfigurationProperties(&quot;spring.datasource.druid.tp-music&quot;)  
    public DataSource twoDataSource() {
        DataSource dataSource = DruidDataSourceBuilder.create().build();
        return dataSource;
    }

    @Bean
    @Primary
    public DynamicDataSource dataSource(DataSource oneDataSource, DataSource twoDataSource) {
        Map&lt;Object, Object&gt; targetDataSources = new HashMap&lt;&gt;(2);
        targetDataSources.put(DataSourceNames.MUSIC, oneDataSource);
        targetDataSources.put(DataSourceNames.TP_MUSIC, twoDataSource);
        // 还有数据源,在targetDataSources中继续添加
        System.out.println(&quot;DataSources:&quot; + targetDataSources);
        return new DynamicDataSource(oneDataSource, targetDataSources);
    }
}

//</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>该类是整个业务的关键类，继承AbstractRoutingDataSource实现动态数据源切换，这个类还并不是很懂</span></strong></mark></span><span class="SemanticString"><span>
public class DynamicDataSource extends AbstractRoutingDataSource {
    private static final ThreadLocal&lt;String&gt; contextHolder = new ThreadLocal&lt;&gt;();

    /**
     * 配置DataSource, defaultTargetDataSource为主数据库
     */
    public DynamicDataSource(DataSource defaultTargetDataSource, Map&lt;Object, Object&gt; targetDataSources) {
        super.setDefaultTargetDataSource(defaultTargetDataSource);
        super.setTargetDataSources(targetDataSources);
        super.afterPropertiesSet();
    }

    @Override
    protected Object determineCurrentLookupKey() {
        return getDataSource();
    }
    public static void setDataSource(String dataSource) {
        contextHolder.set(dataSource);
    }
    public static String getDataSource() {
        return contextHolder.get();
    }
    public static void clearDataSource() {
        contextHolder.remove();
    }
}</span></span></span></code></pre><pre id="https://www.notion.so/198f07d86d6a4a82a81136533587817d" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>//</span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><span>之后就简单了，自定义一个注解类，通过标注在service层的方法上，aop读取注解的值来选择该使用哪个数据源</span></mark></strong></span><span class="SemanticString"><span>
@Documented
@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
public @interface DataSource{
String value()default DataSourceNames.MUSIC;
}

//</span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><span>aop切面类，定义好切换，实现around方法</span></mark></strong></span><span class="SemanticString"><span>
@Aspect
@Component
public class DataSourceAspect implements Ordered {

    @Pointcut(&quot;@annotation(icu.bleuweb.dataSource.DataSource)&quot;)
    public void dataSourcePointCut() {
    }
		@Around(&quot;dataSourcePointCut()&quot;)
    public Object around(ProceedingJoinPoint point) throws Throwable {
		}
}
//使用方法如下。</span></span></span></code></pre><div id="https://www.notion.so/2fd5bdb95e254b4d9d935041777d2936" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Faa9196f6-83e6-4981-834f-930625f9c3f3%2FUntitled.png?width=1093&amp;table=block&amp;id=2fd5bdb9-5e25-4b4d-9d93-5041777d2936"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Faa9196f6-83e6-4981-834f-930625f9c3f3%2FUntitled.png?width=1093&amp;table=block&amp;id=2fd5bdb9-5e25-4b4d-9d93-5041777d2936" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/4f48c1fb7c3a48338b9c9cc7bd1964cd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/4f48c1fb7c3a48338b9c9cc7bd1964cd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Spring Security + jwt + redis登录部分</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/8f64e9480ba74fd998d16ae019bc381e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">整合Spring Security</span></span><div id="https://www.notion.so/b997d534ef6a438a87356dcb2d3bf484" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这部分实现暂未全部完成，暂时只是将</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Spring Security整合</strong></mark></span><span class="SemanticString">进去，使其放行了一些请求，放行了静态资源请求，仅此而已。</span></span></p></div><pre id="https://www.notion.so/93d568be1f3b4e12a9fe5605e44432c5" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>@Override
protected void configure(HttpSecurity http) throws Exception {
	http
			.csrf().disable()//关闭.csrf
			.authorizeRequests()
			.antMatchers(&quot;/user/**&quot;, &quot;/redis/**&quot;, &quot;/yin/**&quot;).permitAll()//放行
			.anyRequest().authenticated()
			.and().addFilterBefore(new CorsFilter(), ChannelProcessingFilter.class)  // 先执行我的过滤器
			.formLogin();
}
@Override
public void configure(WebSecurity web) throws Exception {
    web
          .ignoring().antMatchers(&quot;/**/*.js&quot;,
          &quot;/lang/*.json&quot;, &quot;/**/*.css&quot;,
          &quot;/**/*.js&quot;, &quot;/**/*.map&quot;, &quot;/**/*.html&quot;,
          &quot;/**/*.png&quot;,
          &quot;/img/**/*.png&quot;, &quot;/img/**/*.jpg&quot;,
          &quot;/song/*.mp3&quot;);
}</span></span></span></code></pre></li><li id="https://www.notion.so/173a7569e36746adbbe188000c1f1c27" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">jwt 注册登录逻辑</span></span><div id="https://www.notion.so/eb3f899793924b0da9377bb6f2438f6d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">jwt生成和解析使用的使</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">jjwt</code></strong></span><span class="SemanticString">这个依赖，编写了一个工具类，实现了生成和解析jwt token的方法。</span></span></p></div><pre id="https://www.notion.so/b4b8a79a728044bf8f60950d6f1256e1" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>public class JwtUtils {
	public static String createTokenFromUser(Users user) { }
	public static Claims getBody(String token) { }
}</span></span></span></code></pre><div id="https://www.notion.so/fde70f63ee454362974d02a76a0157b6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">注册无需多说，将用户名密码写入数据库即可。</span></span></p></div><div id="https://www.notion.so/4c7a31d22d68448aa8fdb1be58b7736c" class="ColorfulBlock ColorfulBlock--BgBlue Callout"><div class="Callout__Icon"><div class="Icon">🛠</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">登录的逻辑：
发起登录请求时，查询数据库，生成jwt token，并将userId : token 保存到redis中，过期时间为30分钟
token中包含了用户名，ID，用户角色，过期时间，将token返回给前端。
(前端没法解析jwt token，所以我写了一个请求，如果前端需要用到token包含的用户信息，会发起 /info请求)
#######################################
登录过期的逻辑是：
每次前端页面有任何的跳转都会像后端验证，登录状态是否还是存在的
用户登录超过30分钟，或者redis中保存的</span></span></p></div><pre id="https://www.notion.so/d65fcd164a834edca747130b559955b9" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>@Autowired
private StringRedisTemplate redisTemplate;

@PostMapping(&quot;/login02&quot;)
@WebLog(description = &quot;测试===============================================&gt;&quot;)
public HashMap&lt;String, String&gt;userLogin(@RequestBody Users user) {

    HashMap&lt;String, String&gt;res = new HashMap&lt;&gt;();

    QueryWrapper&lt;Users&gt;query = Wrappers.&lt;Users&gt;query()
			.eq(&quot;name&quot;, user.getName())
			.eq(&quot;password&quot;, user.getPassword());
    Users queryedUser = userService.getOne(query);

    if(queryedUser != null) {
				//生成jwt token返回
        String token = JwtUtils.createTokenFromUser(queryedUser);
        //登录时将用户的登录信息存到redis中， (用户在数据库中的id，生成的token)的形式存放， 30分钟过期。
        redisTemplate.opsForValue().set(String.valueOf(queryedUser.getId()), token, 60 * 30, TimeUnit.SECONDS);
				log.info(&quot;id:token的形式存放到redis中，过期时间30分钟 &quot;
                , new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;)
								.format(new Date().getTime()+ 60 * 30 * 1000));

				res.put(&quot;jwtToken&quot;, token);
		    res.put(&quot;roles&quot;, queryedUser.getRoles()== 0 ? &quot;admin&quot; : &quot;user&quot;);
		}else
        res.put(&quot;state&quot;, &quot;failed, no such user&quot;);
    return res;
}</span></span></span></code></pre><div id="https://www.notion.so/1375371009804b729d97dbc6652c5137" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">同时前端设置了全局的路由守卫，每次的前端路由跳转都会发起</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">@GetMapping(&quot;/isLogin&quot;)</code></span><span class="SemanticString"> ，token作为请求参数</span></span></p></div></li><li id="https://www.notion.so/a641142e4f06443eba4ad138c74eb91c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">aop 切面输出日志</span></span></li></ul><div id="https://www.notion.so/81b227ff557c4a959cb01d4ecfb41520" class="ColorfulBlock ColorfulBlock--ColorDefault ToDo"><div class="ToDo__Content"><div class="ToDo__Icon"><div class="IconCheckboxUnchecked"><svg viewBox="0 0 16 16"><path d="M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"></path></svg></div></div><div class="ToDo__Title"><span class="SemanticStringArray"><span class="SemanticString">Still Optimizing ……</span></span></div></div></div><div id="https://www.notion.so/6d9aac896cdf41059c154d72dd4e6677" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/95cacdd8a79c4cb9b95a313a8031abee" class="Divider"></div><h1 id="https://www.notion.so/6736f9ea74b946df8d418809a9bb4359" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/6736f9ea74b946df8d418809a9bb4359"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">前端 - 管理后台</span></span></h1><div id="https://www.notion.so/8eebd0f41c84415db0251501ed07c080" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">后台的网页利用</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/PanJiaChen/vue-element-admin">PanJiaChen/vue-element-admin</a></span><span class="SemanticString">项目来开发，多谢这位大佬，大大减少了我前端的开发工作量。</span></span></p></div><div id="https://www.notion.so/4bd86608a8694aee8f34cbd2e10a89cf" class="Bookmark"><a href="https://github.com/PanJiaChen/vue-element-admin"><h5 class="Bookmark__Title">PanJiaChen/vue-element-admin</h5><p class="Bookmark__Desc">SPONSORED BY vue-element-admin is a production-ready front-end solution for admin interfaces. It is based on vue and uses the UI Toolkit element-ui. vue-element-admin is based on the newest development stack of vue and it has a built-in i18n solution, typical templates for enterprise applications, and lots of awesome features.</p><p class="Bookmark__Link">https://github.com/PanJiaChen/vue-element-admin</p></a></div><div id="https://www.notion.so/880b50fd4b084aaa9ba1e9d7a79b3b94" class="Divider"></div><div id="https://www.notion.so/ba32d5cf4c87467589ec0e1651948b77" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">demo，主要就是完成了管理端的表格</span></span></p></div><div id="https://www.notion.so/81074ccd47e64aba80b5cfbb647efe96" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F27814609-fb4a-449c-bc58-d9a19afdb90f%2FUntitled.png?width=1898&amp;table=block&amp;id=81074ccd-47e6-4aba-80b5-cfbb647efe96"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F27814609-fb4a-449c-bc58-d9a19afdb90f%2FUntitled.png?width=1898&amp;table=block&amp;id=81074ccd-47e6-4aba-80b5-cfbb647efe96" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/53d2b8cee58547a4b5541c4de522f2e0" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbaa89662-a83f-4558-9fe5-9db839c94227%2FUntitled.png?width=1894&amp;table=block&amp;id=53d2b8ce-e585-47a4-b554-1c4de522f2e0"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbaa89662-a83f-4558-9fe5-9db839c94227%2FUntitled.png?width=1894&amp;table=block&amp;id=53d2b8ce-e585-47a4-b554-1c4de522f2e0" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/1d1b74f347044d7983f8d82e8b54f30d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1d1b74f347044d7983f8d82e8b54f30d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">主要技术点</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/1216c42b098342fb8509affbdf82724b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">大量的时间学习熟悉Vue前端框架，上手</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">Vue-Element-Admin</mark></span><span class="SemanticString">项目整个代码。</span></span></li><li id="https://www.notion.so/a86bf716bcb34193bad26c49d05ac8c9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">利用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Axios</code></strong></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">重写后端请求</strong></mark></span><span class="SemanticString">（原本使用的时mock server，无后端）。</span></span></li><li id="https://www.notion.so/2d986469f72a4a39910ba93b15fc5507" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Vue+ElementUI</code></strong></span><span class="SemanticString">从零开发了一个</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">table网页</mark></strong></span><span class="SemanticString">，如上。</span></span></li><li id="https://www.notion.so/861ce2ba71c84400b540da2339d9ede0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">改动了登录逻辑，</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">重构了全局路由</strong></mark></span><span class="SemanticString">。</span></span></li></ul><h1 id="https://www.notion.so/7401871d020b4306ae7e6a90c3df37b1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/7401871d020b4306ae7e6a90c3df37b1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">前端 - 音乐网站</span></span></h1><div id="https://www.notion.so/e94738bbddf94f3d85c391e33343d674" class="ColorfulBlock ColorfulBlock--ColorDefault ToDo"><div class="ToDo__Content"><div class="ToDo__Icon"><div class="IconCheckboxUnchecked"><svg viewBox="0 0 16 16"><path d="M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"></path></svg></div></div><div class="ToDo__Title"><span class="SemanticStringArray"><span class="SemanticString">TBD</span></span></div></div></div></article>
  <footer class="Footer">
        <div>&copy; Project_Blog 2019</div>
        <div>&centerdot;</div>
        <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>